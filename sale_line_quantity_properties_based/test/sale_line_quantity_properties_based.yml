-
    In order to test the sale_line_quantity_properties_based,
    I start by creating a new unit of measure category 'Surface'
-
    !record {model: product.uom.categ, id:  product_uom_categ_area}:
        name: Surface
-
    I create the unit of measure square meter
-
    !record {model: product.uom, id:  product_uom_m2}:
        name: mÂ²
        category_id: product_uom_categ_area
-
    I create a product 'shelf'
-
    !record {model: product.product, id:  product_product_shelf}:
        categ_id: product.product_category_all
        name: shelf
        type: product
        uom_id: product_uom_m2
        list_price: 1.0
-
    I create a property group 'length'
-
    !record {model: mrp.property.group, id:  mrp_property_group_length}:
        name: length
-
    I create a property group 'width'
-
    !record {model: mrp.property.group, id:  mrp_property_group_width}:
        name: width
-
    I create a property 'length 4'
-
    !record {model: mrp.property, id:  mrp_property_length_4}:
        name: length 4
        group_id: mrp_property_group_length
        description: 4
-
    I create a property 'width 0.5'
-
    !record {model: mrp.property, id:  mrp_property_length_width_05}:
        name: width 0.5
        group_id: mrp_property_group_width
        description: 0.5
-
    I create the formula surface
-
    !record {model: sale.order.line.quantity.formula, id:  sale_order_line_quantity_formula_surface}:
        name: surface
        formula_text: P['width'] * P['length']
-
    Now i create a sale order with an order line that uses properties and formula previously created
-
    !record {model: sale.order, id: sale_order_formula}:
        partner_id: base.res_partner_1
        order_line:
          - product_id: product_product_shelf
            property_ids: 
                - mrp_property_length_4
                - mrp_property_length_width_05
            formula_id: sale_order_line_quantity_formula_surface
            product_uos_qty: 6
-
  I verify that the quantity product has been correctly calculated using the formula
-
  !assert {model: sale.order, id: sale_order_formula, string: The formula was not correctly calculated}:
    - order_line[0].product_uom_qty == 4 * 0.5 * 6
